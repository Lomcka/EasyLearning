<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="mod_fold_style.css">
    <title>Модуль</title>
    <style>
        /* Стили для модуля */
        .module-header {
            text-align: center;
            margin-bottom: 20px;
        }

        .module-header h2 {
            margin: 0;
            font-size: 24px;
        }

        .module-card {
            background-color: #f2f2f2;
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .module-card h3 {
            margin: 0;
            font-size: 18px;
        }

        .module-card ul {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .module-card li {
            padding: 5px 0;
            border-bottom: 1px solid #ccc;
        }

        .module-card li:last-child {
            border-bottom: none;
        }

        .back-button {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px;
            background-color: #333;
            color: #fff;
            border: none;
            border-radius: 3px;
            text-decoration: none;
            text-align: center;
            cursor: pointer;
        }

        .back-button:hover {
            background-color: #555;
        }

        .buttons {
            text-align: center;
            margin-bottom: 10px;
        }

        .buttons button {
            padding: 10px 20px;
            background-color: #00BFFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .add-button {
            display: block;
            width: 150px;
            margin: 0 auto;
            padding: 10px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .buttons button:hover {
            background-color: #00D0FF;
        }

        .buttons .add-button:hover {
            background-color: #45C049;
        }

        /* Стили для модальных окон */
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            background-color: #fefefe;
            margin: 10% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 300px;
            border-radius: 5px;
            position: relative;
        }

        .close-button {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            font-weight: bold;
            color: #888;
            cursor: pointer;
        }

        .close-button:hover {
            color: #555;
        }

    </style>
</head>
<body>
<div class="module-header">
    <h2 id="module-title"></h2>
</div>

<div class="buttons">
    <button id="cards-button" onclick="showCards()">Карточки</button>
    <button id="share-button" onclick="showModal('share-module-form')">Поделиться модулем</button>
</div>

<div id="modules-container"></div>

<button class="add-button" onclick="showModal('add-card-form')">+</button>

<button class="back-button" onclick="goBack()">Назад</button>

<!-- Add Card Form (Hidden by Default) -->
<div id="add-card-form" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeModal('add-card-form')">&times;</span>
        <h3>Добавить карточку</h3>
        <form id="card-form">
            <label>
                Слово:
                <input type="text" id="word-input" required>
            </label>
            <label>
                Перевод:
                <input type="text" id="translation-input" required>
            </label>
            <button type="submit" onclick="addCard(event)">Ок</button>
        </form>
    </div>
</div>

<!-- Share Module Form (Hidden by Default) -->
<div id="share-module-form" class="modal">
    <div class="modal-content">
        <span class="close-button" onclick="closeModal('share-module-form')">&times;</span>
        <h3>Поделиться модулем</h3>
        <form id="share-form">
            <div>
            <label>
                Имя пользователя:
                <input type="text" id="username-input" required>
            </label>
            </div>
            <div>
                <label>
                Кодовое слово пользователя:
                <input type="password" id="password-input" required>
            </label>
            </div>
            <button type="submit" onclick="shareModule(event)">Ок</button>
        </form>
    </div>
</div>

<script>
    function renderModules(modules) {
        const modulesContainer = document.getElementById('modules-container');

        modules.forEach(module => {
            const moduleDiv = document.createElement('div');
            moduleDiv.classList.add('module-card');

            const moduleName = document.createElement('h3');
            moduleName.textContent = module.name;

            const moduleContent = document.createElement('ul');
            module.content.forEach(item => {
                const listItem = document.createElement('li');
                listItem.textContent = `${item.word} - ${item.translation}`;
                moduleContent.appendChild(listItem);
            });

            moduleDiv.appendChild(moduleName);
            moduleDiv.appendChild(moduleContent);

            modulesContainer.appendChild(moduleDiv);
        });
    }

    function showCards() {
        window.location.href = 'cards.html';
    }

    function showModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.style.display = 'block';
    }

    function closeModal(modalId) {
        const modal = document.getElementById(modalId);
        modal.style.display = 'none';
    }

    function addCard(event) {
        event.preventDefault();

        const wordInput = document.getElementById('word-input');
        const translationInput = document.getElementById('translation-input');

        const cardData = {
            word: wordInput.value,
            translation: translationInput.value
        };

        wordInput.value = '';
        translationInput.value = '';

        // Send cardData to localhost:8070 using fetch
        fetch('http://localhost:8070/addCard', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(cardData)
        })
        .then(response => response.json())
        .then(data => {
            // Handle the response from the server
            console.log(data);
            closeModal('add-card-form');
        })
        .catch(error => {
            // Handle any errors
            console.error('Error:', error);
        });
    }

    function shareModule(event) {
        event.preventDefault();

        const usernameInput = document.getElementById('username-input');
        const passwordInput = document.getElementById('password-input');

        const shareData = {
            username: usernameInput.value,
            password: passwordInput.value
        };

        usernameInput.value = '';
        passwordInput.value = '';

        // Send shareData to localhost:8070 using fetch
        fetch('http://localhost:8070/shareModule', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(shareData)
        })
        .then(response => response.json())
        .then(data => {
            // Handle the response from the server
            console.log(data);
            closeModal('share-module-form');
        })
        .catch(error => {
            // Handle any errors
            console.error('Error:', error);
        });
    }

    function goBack() {
        window.history.back();
    }

    // Fetch moduleData from localhost:8070 using fetch
    fetch('http://localhost:8070/getModuleData')
        .then(response => response.json())
        .then(data => {
            // Handle the response from the server
            console.log(data);
            document.getElementById('module-title').textContent = data.name;
            renderModules(data.content);
        })
        .catch(error => {
            // Handle any errors
            console.error('Error:', error);
        });
</script>
</body>
</html>
